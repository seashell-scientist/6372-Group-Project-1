---
title: "6372 EDA moviedata"
author: "Jonathan Tan"
date: "9/17/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

```

```{r import}
#insert your movie database file here

mdata <- readxl::read_xlsx("./2014 and 2015 CSM dataset.xlsx")

#mdata <- readxl::read_xlsx("D:/SMU/DS 6372 Applied Statistics/Sample Datasets/2014 and 2015 CSM dataset.xlsx")

head(mdata)
```
```{r correlation}
#skim the data 
library(skimr)
skim(mdata)
#From this correlation plot, we can see the correlation among variables with the original data.  I think the dependent variable should be gross or ratings.  Look at the variables that are correlated.  
install.packages("corrplot")
library(corrplot)
correlations <- cor(mdata[, c(2,3, 5:14)])
corrplot(correlations, method="circle")


###Best First Model
#Model 1-From this model as Gross as the dependent variable, we can see that Aggregate.Follwers, Ratings, Budget, and Screens are significant.
mod1 <- lm(Gross ~ Genre + Year + Ratings + Budget + Screens+ Sequel+ Sentiment + Views + Likes + Dislikes + Comments + Aggregate.Followers, data=mdata)
print(summary(mod1))

#Baseline model of Model 1.
mod1a <- lm(Gross ~ Ratings + Budget + Screens+ Aggregate.Followers, data=mdata)
print(summary(mod1a))

library(ggplot2)
ggplot(mdata, aes(x = Ratings, y = Gross)) +  geom_point()  + geom_smooth(method="lm")
```
#From this plot and this model, we see a positive correlation between gross and ratings.  
From the plot we see that the distribution of gross is pretty skewed and I had an idea came up to find out what determines a movie that makes more than 50 million dollars.
Then the dependent variable is a binary response variable, taking value 1 if it makes more than $50M
And taking value 0 otherwise.
So we can run a logistic model with that to predict which movies would make more than $50 million.

############################Other possible first models
#Model 2
```{r, class.source="answer", echo=T}
mod2 <- lm(Ratings ~ Genre + Year + Gross + Budget + Screens+ Sequel+ Sentiment + Views + Likes + Dislikes + Comments + Aggregate.Followers, data=mdata)
print(summary(mod2))
```

#Model 3
```{r, class.source="answer", echo=T}
mod3 <- lm(Likes ~ Genre + Year + Ratings + Budget + Screens+ Sequel+ Gross + Views + Sentiment + Dislikes + Comments + Aggregate.Followers, data=mdata)
print(summary(mod3))
```

```{r correlation}
#skim the data 
library(skimr)
skim(mdata)
#From this correlation plot, we can see the correlation among variables with the original data.  I think the dependent variable should be gross or ratings.  Look at the variables that are correlated.  
install.packages("corrplot")
library(corrplot)
correlations <- cor(mdata[, c(2,3, 5:14)])
corrplot(correlations, method="circle")


###Best First Model
#Model 1-From this model as Gross as the dependent variable, we can see that Aggregate.Follwers, Ratings, Budget, and Screens are significant.
mod1 <- lm(Gross ~ Genre + Year + Ratings + Budget + Screens+ Sequel+ Sentiment + Views + Likes + Dislikes + Comments + Aggregate.Followers, data=mdata)
print(summary(mod1))

#Baseline model of Model 1.
mod1a <- lm(Gross ~ Ratings + Budget + Screens+ Aggregate.Followers, data=mdata)
print(summary(mod1a))


library(ggplot2)
ggplot(mdata, aes(x = Ratings, y = Gross)) +  geom_point()  + geom_smooth(method="lm")

#From this plot and this model, we see a positive correlation between gross and ratings.  
From the plot we see that the distribution of gross is pretty skewed and I had an idea came up to find out what determines a movie that makes more than 50 million dollars.
Then the dependent variable is a binary response variable, taking value 1 if it makes more than $50M
And taking value 0 otherwise.
So we can run a logistic model with that to predict which movies would make more than $50 million.

############################Other possible first models
#Model 2
mod2 <- lm(Ratings ~ Genre + Year + Gross + Budget + Screens+ Sequel+ Sentiment + Views + Likes + Dislikes + Comments + Aggregate.Followers, data=mdata)
print(summary(mod2))


#Model 3
mod3 <- lm(Likes ~ Genre + Year + Ratings + Budget + Screens+ Sequel+ Gross + Views + Sentiment + Dislikes + Comments + Aggregate.Followers, data=mdata)
print(summary(mod3))

```

```{r inital visualizations}
library(ggplot2)

ggplot(data = mdata, aes(x = Ratings, y = Gross))+
  geom_bin2d(bins = 20)+
  labs(title = "Movie Ratings VS Gross")
```

```{r vis2}
ggplot()+
  geom_histogram(data = mdata, aes(x = Screens, fill = I("Blue")), binwidth = 40)

ggplot(data = mdata, aes(x = Screens, y = Gross))+
  geom_line()
```


```{r vis3}
ggplot(data = mdata, aes(x = Budget, y = Gross, color = factor(Year)))+
  geom_line(linejoin = "round")
 
ggplot(data = mdata, aes(sample = Gross, color = Year))+
  geom_qq()

```


roughly positive correlation between gross and rating, screens obviously positively correlates with gross. 

the distribution isn't normal, lots of small presumably indie films that didn't make much gross or have many theater showings, and a few huge blockbusters


```{r prelim model1}
m1 <- lm(Gross ~ Budget + Screens, data = mdata)

summary(m1)
layout(matrix(c(1, 2, 3, 4), 2, 2)) 
plot(m1)
```

```{r prelim model2}
m2 <- lm(Gross ~ Budget + Screens + Budget*Screens, data = mdata)
#with multvar
summary(m2)
layout(matrix(c(1, 2, 3, 4), 2, 2)) 
plot(m2)
```

```{r var scatter}
varpool <- names(mdata) #varnames
varpool <- varpool[-5] #take out gross 
z <- seq(1, length(varpool), 1) #number of var iterations 

i = 0
x = 0
y <- vector()
#would like to create iterative arrays in the for loop, but not sure how to use i to iterate names

for( i in z)
{
 x <- t(combn(varpool, i)) #generate combinations of i variables
 comboname <- paste("combos", i)
 assign(comboname, x)
}
```

```{r iterative var paste test}
d <- 5
for (i in 1:10)
{
  nam <- paste("combo", i)
  assign(nam, )
}
```