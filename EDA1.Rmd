---
title: "6372 EDA moviedata"
author: "Jonathan Tan"
date: "9/17/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r import}
#insert your movie database file here

mdata <- readxl::read_xlsx("./2014 and 2015 CSM dataset.xlsx")

#mdata <- readxl::read_xlsx("D:/SMU/DS 6372 Applied Statistics/Sample Datasets/2014 and 2015 CSM dataset.xlsx")

head(mdata)

```
```{r Datamaid checking variables, echo=T}

library(dplyr)
library(dataMaid)
library(tidyverse)
`%!in%` = Negate(`%in%`)

#{bjh}does a lot of checks automatically and outputs a PDF report, 
#I haven't had time to go through it in detail yet
makeDataReport(mdata,replace = TRUE)

#Let me try to remove some of the outliers DataMaid suggested and redo the plots
#Takes it from 231 observations to 205, probably need to scale this back a little bit
mdata_noOutliers<-mdata %>% 
  filter(Movie!="Left Behind") %>% #Ratings 3.1 
  filter(Movie !="Jurassic World") %>% # GROSS
  filter(Screens <=4080) %>%  #SCREENS
  #filter(Sentiment>0) %>% #SENTIMENT ALL NEGATIVES ARE OUTLIERS this is too aggressive it removes half the data
  filter(Movie %!in% c("The Fault in Our Stars","Fifty Shades of Grey")) %>%  #VIEWS ABOVE 31859569
  filter(Movie %!in% c("The Fault in Our Stars","Not Cool")) %>%  #LIKES ABOVE 187162
  filter(Dislikes <= 3439) %>% #DISLIKES 
  filter(Comments <= 18077) #COMMENTS

makeDataReport(mdata_noOutliers,replace = TRUE)

library("PerformanceAnalytics")

a<- mdata_noOutliers %>% select_if(is.numeric)
chart.Correlation(a , histogram=TRUE, pch=19)
```


```{r inital visualizations}
library(ggplot2)

ggplot(data = mdata, aes(x = Ratings, y = Gross))+
  geom_bin2d(bins = 20)+
  labs(title = "Movie Ratings VS Gross")
```

```{r vis2}
ggplot()+
  geom_histogram(data = mdata, aes(x = Screens, fill = I("yellow")), binwidth = 40)

ggplot(data = mdata, aes(x = Screens, y = Gross))+
  geom_line()
```


```{r vis3}
ggplot(data = mdata, aes(x = Budget, y = Gross, color = factor(Year)))+
  geom_line(linejoin = "round")
 
ggplot(data = mdata, aes(sample = Gross, color = Year))+
  geom_qq()

```


roughly positive correlation between gross and rating, screens obviously positively correlates with gross. 

the distribution isn't normal, lots of small presumably indie films that didn't make much gross or have many theater showings, and a few huge blockbusters






